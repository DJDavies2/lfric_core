!-------------------------------------------------------------------------------
! (c) The copyright relating to this work is owned jointly by the Crown, 
! Met Office and NERC 2014. 
! However, it has been created with the help of the GungHo Consortium, 
! whose members are identified at https://puma.nerc.ac.uk/trac/GungHo/wiki
!-------------------------------------------------------------------------------
!
!-------------------------------------------------------------------------------
module quadrature_mod_test
  implicit none 

contains

  @test
  subroutine test_quadrature()
    use pFUnit_Mod
    use quadrature_mod, only : quadrature_type, QR3
    use constants_mod, only : r_def
    implicit none

    real(kind=r_def) :: polynomial(9,3)
    real(kind=r_def) :: result, answer, epsilon
    integer          :: test_qr
    
    integer :: nqp_h, nqp_v
    type(quadrature_type), pointer :: qr => null()

    nqp_h=9
    nqp_v=3

    qr => qr%get_instance(QR3, nqp_h, nqp_v)

    test_qr = qr%which()
    @assertEqual(test_qr,QR3)

    polynomial = 0.33333333333333333333333_r_def

    result = qr%integrate(polynomial)

    answer = 0.33333333333333333333333_r_def

    epsilon = 1.0e-14_r_def

    @assertEqual( answer, result, epsilon )

  end subroutine test_quadrature

end module quadrature_mod_test
